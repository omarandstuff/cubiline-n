using UnityEngine;
using System.Collections;

public class CubilineTarget : MonoBehaviour
{
	//////////////////////////////////////////////////////////////
	///////////////////////// COMPONENTS /////////////////////////
	//////////////////////////////////////////////////////////////

	public GameObject particlePrefab;

	//////////////////////////////////////////////////////////////
	///////////////////////// PARAMETERS /////////////////////////
	//////////////////////////////////////////////////////////////

	public string targetTag;
	public bool activated = false;
	public int index;
	public int toGrow = 1;
	public int score = 1;
	public Vector3 targetScale;
	public float scaleTime = 0.3f;

	//////////////////////////////////////////////////////////////
	////////////////////// CONTROL VARIABLES /////////////////////
	//////////////////////////////////////////////////////////////

	private Vector3 scaleVelocity = Vector3.zero;

	////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////// MONO BEHAVIOR ////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////

	void Start()
	{
		transform.localScale = Vector3.zero;
	}

	void FixedUpdate()
	{
		if (transform.localScale != targetScale) transform.localScale = Vector3.SmoothDamp(transform.localScale, targetScale, ref scaleVelocity, scaleTime);
	}

	void OnTriggerEnter(Collider other)
	{
		if (other.tag == "Player")
		{
			activated = true;
			Destroy(Instantiate(particlePrefab, transform.position, Quaternion.identity), 8.0f);
			foreach (Collider c in GetComponents<Collider>())
				c.enabled = false;
			GetComponent<MeshRenderer>().enabled = false;
			GetComponent<AudioSource>().Play();
		}
	}
}
